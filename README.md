# 材料孔洞交叉项目

#### 介绍
2023年5月，计算机视觉与材料工程学科交叉科研项目初步结束，代码归档

#### 代码架构
##### 1.match_main.py
此文件是框架主体，实现对材料孔洞的初步识别，输出判别的矩形标注框，其格式参考yolo数据集txt标签。
框架基本思路是经sauvola算法二值化处理之后，用霍夫变换初筛可能的圆。
在此基础上，将霍夫变换获取的圆经过均值等处理后作为模板信息。
对全局进行匹配搜索，获得匹配值矩阵，映射回原图坐标得到孔洞位置。
其余包括标注框去重、匹配阈值迭代等具体细节见代码。
##### 2.calculate_avgbub.py 
此文件用于计算出此张图中孔洞的平均半径
##### 3.calculate_iou.py
此文件根据既有的测试集对检测结果进行量化分析，导入测试集以及预测数据
测试集总数先默认算FN(理解为全部没找出来)，预测总数先默认算FP(理解为全部找错了)
嵌套循环，每一个预测数据与所有的测试集求iou，取出max，
max与设置的iou阈值进行比较，判正一个 +TP -FP -FN，
计算precision, recall, F1-score，详细细节见代码
##### 4.circle2rectangle.py 
此文件将圆形的标注格式（圆形坐标，半径），转换为YOLO格式的标签，输出在txt
##### 5.draw_plt.py
此文件用于绘制折线图
##### 6.find_circle.py
此文件用于从 既有的无直接的坐标信息 但已在图像中标注好 的数据集 中提取出圆的圆形半径信息
##### 7.print_on_img.py
此文件读取txt标注信息，将标注框打印在原图上，可视化检视检测效果，可用labelimg代替
##### 8.Kmeans_l_bubble.py
在初步阶段对于大尺度多尺度的对象，模板匹配框架效果不佳，以此聚类算法作为补充。
但存在多噪声，无结果导出等局限性。
##### 9.yolov5_7for_bubble文件夹
其是完整的yolov5工程，在此项目中用以更准确的识别
#### 使用说明
项目初期使用match_main.py以及Kmeans_l_bubble.py脚本以对材料孔洞实现初步判别，
calculate_iou.py在此阶段进行效果评估，在上述传统框架具备一定的精度后，将其输出结果作为
初步的数据集，使用yolo完成更高精度的任务。

#### 其他
在项目日志中粗略记录了我的摸索与尝试过程。